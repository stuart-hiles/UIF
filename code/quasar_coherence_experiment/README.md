# UIF Quasar Coherence Experiment â€” Code

This folder contains the full Python code used to reproduce the *quasarâ€“quasar coherence* and *informational synchronisation* analyses presented in the UIF Companion Experiments and UIF PaperÂ IV.

The purpose of this experiment is to quantify:
- largeâ€‘scale quasarâ€“quasar coherence,
- Î”I-based synchronisation metrics,
- HCâ€‘plane classification of quasar lightâ€‘curve behaviour,
- logistic fits and collapseâ€‘band diagnostics.

All analyses are fully reproducible using the scripts below together with the datasets located in:

```
/UIF/data/quasar_coherence_experiment/
/UIF/output/quasar_coherence_experiment/
```

---

## ğŸ“ Scripts in this folder

### **`ut26_quasar_full_run_v4.py`**
**Main driver pipeline.**  
Runs the full quasarâ€‘coherence experiment endâ€‘toâ€‘end:
- Loads the merged StripeÂ 82 lightâ€‘curve dataset  
- Computes informational metrics (Î”I, Î“, Î»á´¿, Î·*, Râˆ, k)  
- Performs HCâ€‘plane classification  
- Generates coherence maps, subpopulation statistics, and diagnostics  
- Writes all outputs to the corresponding folder under `/output/quasar_coherence_experiment/`

This script is the entry point for full experiment replication.

---

### **`ut26_fit_coherence_models.py`**
Performs statistical model fitting on the outputs generated by the full run:
- Logistic regression for HCâ€‘plane stability boundaries  
- Regression of coherence vs. magnitude, mass, and redshift  
- Bootstrap CIs for slopes and intercepts  
- Generates publicationâ€‘ready tables used in the Companion and PaperÂ IV  

Outputs are written to:
```
/UIF/output/quasar_coherence_experiment/model_fits/
```

---

## ğŸ”§ Requirements

- Python 3.10+
- NumPy, SciPy
- Pandas
- Matplotlib
- Astropy
- scikitâ€‘learn

A full `requirements.txt` file will be added in the repository root.

---

## â–¶ï¸ Running the Experiment

### **1. Run the full coherence pipeline**
```bash
python ut26_quasar_full_run_v4.py
```

This generates:
- coherence metrics  
- HCâ€‘plane arrays  
- Î”I/Î“ maps  
- diagnostic figures  
- summary JSON  
- bootstrapped outputs

### **2. Fit statistical models**
```bash
python ut26_fit_coherence_models.py
```

This produces:
- logisticâ€‘fit boundaries  
- bootstrap confidence intervals  
- slope tables used in UIF publications  

---

## ğŸ“„ Output Structure

The corresponding outputs live in:

```
/UIF/output/quasar_coherence_experiment/
```

This folder contains:
- `summary.json` â€“ experiment metadata + operator metrics  
- `HC_plane.png` â€“ coherence vs collapseâ€‘threshold map  
- Î”I maps, Î“ sweeps  
- slope CSVs  
- bootstrapped logistic boundary curves  
- publication figures  

---

## ğŸ” Reproducibility Notes

- All results are fully deterministic given the fixed random seed (stored in `summary.json`).  
- The exact file list and data sources are documented in  
  `/UIF/data/quasar_coherence_experiment/README.md`  
- The experiment was run using merged SDSS StripeÂ 82 datasets prepared specifically for UIF.

For completeness, the Companion Appendix B includes a formal reproducibility table covering datasets, scripts, outputs, and run tags.

---

If you'd like, I can also automatically generate:
- the matching README for `/data/quasar_coherence_experiment/`
- the README for `/output/quasar_coherence_experiment/`
- a combined reproducibility block for the appendix.


